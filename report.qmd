---
title: "Report"
subtitle: "**MUSINSA 기업 분석**"
author: 언론홍보학과 2021202027 최성진
date: 2022-12-07
format:
  revealjs: 
    theme: serif
    transition: slide
    background-transition: fade
    footer: "[Home](https://choiiiiis.github.io/tmm_web/)"
---

## 목차

|
|

1.  기업 소개
2.  분석 목적
3.  데이터셋 수집 및 정제
4.  데이터 분석
5.  결론

# 기업 소개

## 기업 소개{.smaller}

|
|

![](docs/musinsa_logo.jpg){width=450px}

|
|

- 국내 최대 의류 아울렛 플랫폼
- 21년 기준 연매출 4,667억 원, 영업이익 542억 원
- 10번 째 유니콘 기업 선정

# 분석 목적

## 분석 목적

|
|

- 기업 분석을 통해 무신사가 갖는 독보적 BI를 확인하고, 경쟁사와 차별점과 패션 업계 트렌드를 중심으로 나아가야 할 방향과 전략을 제시하고자 함.

```{mermaid}
%%| fig-width: 8
flowchart LR
  A(자료 수집) --> B(자료 분석)
  B --> C{결과 도출}
  C --> D(전략 제안)
  C --> E(위기 관리)
```

# 데이터셋 수집 및 정제

## 한국언론진흥재단 빅카인즈{.smaller}

|
|

* 패션 브랜드 간 비교
    + **무신사, 패션 브랜드** 키워드 검색.
    + 2021.09.27 - 2022.09.27 무신사 2,056건, 패션 플랫폼 1,330건 확보.

|
|

* 연간 비교
    + **무신사** 키워드 검색.
    + 2021.01.01 - 2021.10.04 간 1,413건, 2022.01.01 - 2022.10.04 간 1,597건 확보.

## 한국언론진흥재단 빅카인즈{.smaller}

|
|

* 트렌드 분석
    + **패션 트렌드** 키워드 검색.
    + 2021.01.01 - 2021.10.12 간 1,122건, 2022.01.01 - 2022.10.12 간 1,148건 확보.

|
|

* 위기 분석
    + **무신사, 패션 브랜드, 위기, 논란** 키워드 검색
    + 2021.01.01 - 2021.10.30 간 816건, 2022.01.01 - 2022.10.30 간 745건 확보.

## 주요 코드 수정 내용{.smaller}

|
|

- 브랜드 명 "무신사"가 "무신 + 사"로 반영돼 사전에 "무신사" 추가.

```{.python code-line-numbers="2"}
buildDictionary(ext_dic = c('sejong', 'woorimalsam'),
                user_dic = data.frame(term="무신사", tag='ncn'),
                category_dic_nms=c('brand'))
```

|
|

- 무의미하게 반복되는 단어 제거.
```{.python code-line-numbers="3"}
musinsa_topic_tk <- 
musinsa_topic_tk %>% 
  filter(!word %in% c("기자", "투데이", "가운데", "경제뉴스")) %>% 
  filter(str_detect(word, "[:alpha:]+"))
```


# 데이터 분석

## SWOT 분석{.smaller}

```{r}
#| label: data_ready
#| results: hide
#| warning: false

pkg_v <- c("tidyverse", "tidytext", "readxl", "kableExtra", 
           "multilinguer", "RcppMeCab", "KoNLP", "lubridate", 
           "tidylo", "stm", "reshape2", "dplyr", "ggplot2", 
           "stringr", "rvest", "wordcloud", "gt")

# 패키지 설치 시 사용
#( pkg_v_installed <- pkg_v %in% installed.packages()[,"Package"] )

#( new_pkg <- pkg_v[!pkg_v_installed] )

#if(length(new_pkg)) install.packages(new_pkg)

lapply(pkg_v, require, ch = T)

musinsa_df <- 
readxl::read_excel("data/NewsResult_20210927-20220927_musinsa.xlsx") %>% 
  select(일자, 제목, 본문, cat = `통합 분류1`) 

plat_df <- 
readxl::read_excel("data/NewsResult_20210927-20220927_plat.xlsx") %>% 
  select(일자, 제목, 본문, cat = `통합 분류1`) 

```

```{r}
#| label: musinsa_all
#| results: hide
#| warning: false
#| fig-width: 5
#| fig-align: left
#| fig

# "무신사"가 "무신 + 사"로 반영되어 사전에 "무신사" 추가
#buildDictionary(ext_dic = c('sejong', 'woorimalsam'),
#                user_dic = data.frame(term="무신사", tag='ncn'),
#                category_dic_nms=c('brand'))

musinsa2_df <- 
musinsa_df %>% 
  distinct(제목, .keep_all = T) %>% 
  mutate(ID = factor(row_number())) %>% 
  mutate(label = "0") %>%
  unite(제목, 본문, col = "text", sep = " ") %>% 
  mutate(text = str_squish(text))

musinsa_tk <- musinsa2_df %>% 
  mutate(text = str_remove_all(text, "[^(\\w+|\\s)]")) %>%  
  unnest_tokens(word, text, token = extractNoun, drop = F) %>%
#  separate(word, c("word", "pos"), sep = "/") %>% 
#  filter(pos == "nng") %>% 
  count(word, sort = T)

musinsa_tk <- 
musinsa_tk %>% 
  filter(!word %in% c("무신사", "MUSINSA", "기자")) %>% 
  filter(str_detect(word, "[:alpha:]+"))

musinsa_tk %>%
  filter(str_length(word) > 1) %>%
  slice_max(n, n = 15) %>% 
  mutate(word = reorder(word, n)) %>% 
  ggplot(aes(word, n)) +
  geom_col() +
  coord_flip() +
  labs(title = "무신사 총빈도")

```

```{r}
#| label: vs
#| results: false
#| warning: false
#| fig-width: 5
#| fig-align: right

plat2_df <- 
plat_df %>% 
  distinct(제목, .keep_all = T) %>% 
  mutate(ID = factor(row_number())) %>% 
  mutate(label = "1") %>%
  unite(제목, 본문, col = "text", sep = " ") %>% 
  mutate(text = str_squish(text))

plat_tk <- plat2_df %>% 
  mutate(text = str_remove_all(text, "[^(\\w+|\\s)]")) %>%  
  unnest_tokens(word, text, token = extractNoun, drop = F) %>%
  count(word, sort = T)

plat_tk <- 
plat_tk %>% 
  filter(!word %in% c("기자", "패션", "플랫폼")) %>% 
  filter(str_detect(word, "[:alpha:]+"))

vs_df <- rbind(musinsa2_df, plat2_df)

set.seed(5)

vsvs_df <- 
  vs_df[-c(1, 3)] %>% 
  relocate(c(ID, text)) %>%
  group_by(label) %>% 
  sample_n(size = 1300)

rate_odds_df <- 
vsvs_df %>% 
  unnest_tokens(word, text, token = extractNoun) %>% 
#  separate(word, c("word", "pos"), sep = "/") %>% 
#  filter(pos == "nng") %>% 
  count(word) %>% 
  pivot_wider(names_from = label,
              values_from = n, 
              values_fill = list(n = 0)) %>% 
  rename(posi = `1`, nega = `0`) %>% 
  mutate(odds_posi = ((posi+1)/sum(posi+1)),
         odds_nega = ((nega+1)/sum(nega+1))) %>% 
  mutate(posi_odds_ratio = (odds_posi / odds_nega)) %>% 
  filter(rank(posi_odds_ratio) <= 20 | rank(-posi_odds_ratio) <= 20) %>%   arrange(-posi_odds_ratio)

rate_log_df <- 
vsvs_df %>% 
  unnest_tokens(word, text, token = extractNoun) %>% 
#  separate(word, c("word", "pos"), sep = "/") %>% 
#  filter(pos == "nng") %>% 
  count(word) %>% 
  pivot_wider(names_from = label,
              values_from = n, 
              values_fill = list(n = 0)) %>% 
  rename(posi = `1`, nega = `0`) %>% 
  mutate(odds_posi = ((posi+1)/sum(posi+1)),
         odds_nega = ((nega+1)/sum(nega+1))) %>% 
  mutate(log_odds_ratio = log(odds_posi / odds_nega)) 

weighted_log_odds_df <- 
vsvs_df %>% 
  unnest_tokens(word, text, token = extractNoun) %>% 
#  separate(word, c("word", "pos"), sep = "/") %>% 
#  filter(pos == "nng") %>% 
  filter(str_length(word) > 1) %>%
  filter(word != "무신사") %>% 
  filter(word != "fn") %>% 
  filter(word != "기자") %>% 
  count(word) %>% 
  bind_log_odds(set = label,
                feature = word,
                n = n) %>% 
  arrange(-log_odds_weighted)

weighted_log_odds_df %>%
  group_by(label = ifelse(label > 0, "패션 플랫폼", "무신사")) %>%
  slice_max(abs(log_odds_weighted), n = 10) %>%
  ggplot(aes(x = log_odds_weighted,
             y = reorder(word, log_odds_weighted),
             fill = label)) +
  geom_col(show.legend = F) +
  facet_wrap(~label, scale = "free")

```

|
|

- testtesttest

## SWOT 분석

## SWOT 분석

## SWOT 분석

# 결론

## 결론

- Get in bed
- Count sheep

# 감사합니다.